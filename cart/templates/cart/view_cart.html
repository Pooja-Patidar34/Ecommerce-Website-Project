{% extends "products/base.html" %}
{% load static %}
{% block content %}
<div class="container mt-5">
  <h2 class="mt-3">My Cart</h2>
  {% if cart_items %}
  <table class="table table-bordered table-hover mt-4 align-middle text-center">
    <thead class="table-dark">
      <tr>
        <th>Image</th>
        <th>Product</th>
        <th>Price</th>
        <th>Quantity</th>
        <th>Subtotal</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      {% for item in cart_items %}
      <tr>
        <td>
          <img src="{{ item.product.image.url }}" alt="product image" height="60">
        </td>
        <td>{{ item.product.name }}</td>
        <td>Rs {{ item.product.price }}</td>
        <td>
          <div class="input-group">
            <form action="{% url 'update_cart_quantity' item.id 'decrease' %}" method="POST" style="display: inline;">
              {% csrf_token %}
              <button type="submit" class="btn btn-outline-secondary">-</button>
            </form>
            <input type="text" class="form-control text-center" value="{{ item.quantity }}" readonly
              style="max-width: 60px;">
            <form action="{% url 'update_cart_quantity' item.id 'increase' %}" method="POST" style="display: inline;">
              {% csrf_token %}
              <button type="submit" class="btn btn-outline-secondary">+</button>
            </form>
          </div>
        </td>
        <td>Rs {{ item.get_total_price }}</td>
        <td>
          <a href="{% url 'remove_from_cart' item.product_id %}" class="btn btn-danger btn-sm"
            onclick="return confirm('Are you sure you want to remove this item?')">Remove</a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
    <tfoot>
      <tr>
        <td colspan="4" class="text-end"><strong>Total :</strong></td>
        <td><strong>Rs {{ total }}</strong></td>
      </tr>
    </tfoot>
  </table>

  <div class="text-end">
    <a href="{% url 'checkout' %}" class="btn btn-success">Place Order</a>
  </div>
  {% else %}
  <p class="mt-4">Your cart is empty.</p>
  {% endif %}
</div>
{% endblock content %}
