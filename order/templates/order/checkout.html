{% extends "products/base.html" %}
{% block content %}
<div class="container mt-5">
  <h2>Checkout</h2>
  <p><strong>Total Amount:</strong> Rs {{ order.total_amount }}</p>

  <button id="rzp-button1" class="btn btn-primary">Pay with Razorpay</button>
</div>

<script src="https://checkout.razorpay.com/v1/checkout.js"></script>
<script>
var options = {
    "key": "{{ razorpay_key }}",
    "amount": "{{ amount }}",
    "currency": "{{ currency }}",
    "name": "My E-commerce",
    "description": "Order #{{ order.id }}",
    "order_id": "{{ razorpay_order_id }}",
    "handler": function (response){
        // Payment is processed by Razorpay
        alert("Payment Initiated! Waiting for confirmation...");
        window.location.href = "{% url 'order_history' %}";
    },
    "prefill": {
        "name": "{{ request.user.username }}",
        "email": "{{ request.user.email }}"
    },
    "theme": {
        "color": "#3399cc"
    }
};
document.getElementById('rzp-button1').onclick = function(e){
    var rzp1 = new Razorpay(options);
    rzp1.open();
    e.preventDefault();
}
</script>
{% endblock %}
